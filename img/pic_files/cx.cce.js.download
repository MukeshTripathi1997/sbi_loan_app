try{var cX=window.cX=window.cX||{};cX.callQueue=cX.callQueue||[];cX.CCE=cX.CCE||{};cX.CCE.callQueue=cX.CCE.callQueue||[];if(!cX.CCE.library){cX.CCE.library={version:"test",ccePushUrl:"https://comcluster.cxense.com/cce/push?callback={{callback}}",prefix:null,persistedQueryId:null,testGroup:-1,testVariant:null,previewTestId:null,previewCampaign:null,previewDiv:null,previewId:null,offerProductId:null,startTime:new Date,visibilityField:"timeHalf",trackTime:.5,noCache:false,activeSnapPoint:null,snapPoints:[],activeWidgets:[],"__cx-toolkit__":{isShown:false,data:[]},utmParams:[],sendPageViewEvent:function(e,t,i,r){this.init(null,e,t,this.visibilityField,(function(){cX.sendPageViewEvent(i,r)}))},init:function(e,t,i,r,n){this.prefix=t;this.persistedQueryId=i;var s={};if(e){var c=document.getElementsByTagName("script");var a=null;for(var o=0;!a&&o<c.length;++o){if(c[o]&&c[o].src&&c[o].src.indexOf(e)>-1){a=c[o]}}if(a&&a.src&&a.src.indexOf("#")>-1){var l=a.src.replace(/.*#/,"");s=cX.decodeUrlEncodedNameValuePairs(l)}}var u=cX.parseUrlArgs();cX.Object.forEach(u,cX.createDelegate(this,(function(e,t){if(e!==undefined&&t.match(/utm_(source|medium|content|campaign|term)/i)){this.utmParams.push({key:t,value:e})}})));this.testVariant=u.testVariant||s.testVariant||s.ver;this.previewTestId=u.testId||s.testId;this.previewCampaign=u.previewCampaign||s.previewCampaign;this.previewDiv=u.previewDiv||s.previewDiv||"current";this.previewId=u.previewId||s.previewId;this.offerProductId=u.cx_productId||s.cx_productId;this.noCache=u.cx_nocache==="1"||s.cx_nocache==="1";if(this.testGroup===-1){this.testGroup=this.getTestGroup()}if(this.prefix&&this.persistedQueryId){cX.setEventAttributes({origin:this.prefix+"-web",persistedQueryId:this.persistedQueryId})}cX.setCustomParameters({ver:this.version,testGroup:this.testGroup});if(r&&r.length){this.visibilityField=r}if(this.startTime){var d=(new Date-this.startTime)/1e3;if(d>2){cX.setCustomParameters({loadDelay:d.toFixed(1)})}this.startTime=null}if(location.protocol==="http:"){cX.setCustomParameters({insecure:"y"})}this._insertPreview();var f=this._parseSavedParameter("showTools",u,s);if(f){var p=this._parseSavedParameter("useLocalToolkit",u,s);this._showTools(p)}if(n){n()}},_parseSavedParameter:function(e,t,i){try{var r="_cX_"+e;var n=t[e]!==undefined||i[e]!==undefined;var s=t[e]==="1"||i[e]==="1";if(cX.hasLocalStorage()){if(n){localStorage.setItem(r,s?"1":"0")}else{s=localStorage.getItem(r)==="1"}}return s}catch(e){}},setVisibilityField:function(e){this.visibilityField=e},setSnapPoints:function(e){this.snapPoints=e;this.activeSnapPoint=this._getSnapPoint();var t;window.addEventListener("resize",cX.createDelegate(this,(function(){clearTimeout(t);t=setTimeout(cX.createDelegate(this,(function(){this._renderResizedWidgets()})),200)})),false)},_getSnapPoint:function(){var e=this.snapPoints;if(!e.length){return""}var t=cX.getWindowSize().width;for(var i=0;i<e.length;++i){if(t>=e[i].min){return e[i].name}}return e[e.length-1].name},_renderResizedWidgets:function(){var e=this._getSnapPoint();if(e!==this.activeSnapPoint){this.activeSnapPoint=e;for(var t=0;t<this.activeWidgets.length;++t){var i=this.activeWidgets[t];i.context.activeSnapPoint=e;cX.library._renderTemplate(i.templateContent,i.targetId,i.data,i.context)}}},getTestGroup:function(){var e=cX.getUserId();var t=-1;if(e&&e.length){var i=0;for(var r=0;r<e.length;r++){i=(i<<5)-i+e.charCodeAt(r);i|=0}t=Math.abs(i)%100}else{t=Math.floor(Math.random()*100)}return t},_applyContext:function(e,t){if(!e){e={}}if(!e.context){e.context={}}if(!e.context.categories){e.context.categories={}}if(!e.context.parameters){e.context.parameters=[]}var i={};cX.Object.forEach(e.context.categories,(function(t,r){if(t!==undefined){var n=false;var s=r.toLowerCase();i[s]=t;cX.Array.forEach(e.context.parameters,(function(e){n=n||e.key===s}));if(!n){e.context.parameters.push({key:s,value:""+t})}}}));e.context.categories=i;cX.Object.forEach(cX.library.m_rawCustomParameters,(function(t,i){if(i&&t!==undefined){if(!cX.Object.some(e.context.parameters,(function(e){return e.key===i}))){if(cX.isArray(t)){cX.Array.forEach(t,(function(t){e.context.parameters.push({key:i,value:""+t})}))}else{e.context.parameters.push({key:i,value:""+t})}}}}));cX.Array.forEach(this.utmParams,(function(t){e.context.parameters.push({key:t.key,value:""+t.value})}));if(this.previewId===t.widgetId&&this.previewCampaign){e.tag=this.previewCampaign}switch(t.testVariant){case"pn":e.tag="cce1";break;case"none":e.tag="cce2";break;case"ctrl":e.tag="cce3";break;default:break}if(this.testGroup===-1){this.testGroup=this.getTestGroup()}e.context.categories.testgroup=""+this.testGroup;e.context.parameters.push({key:"testgroup",value:""+this.testGroup});if(t&&t.targetElementId){var r=document.getElementById(t.targetElementId);if(r){var n={};var s=[].slice.call(r.querySelectorAll(t&&t.ctrlLinksCss||"a"));for(var c=0;c<s.length;c++){var a=s[c];var o=this._getElemLink(a,t&&t.ctrlSpaAttr);if(a&&o){n[o]=null}}var l=1;for(var u in n){if(n.hasOwnProperty(u)){e.context.parameters.push({key:"ctrlUrl"+l++,value:u})}}}}if(this.noCache){e.context.uncachedSettings=true}return e},reportTestImpression:function(e,t){},_reportWidgetVisible:function(e,t,i){for(var r=0;r<i.length;++r){var n=i[r];if(n.click_url){var s={impressions:[{clickUrl:n.click_url,visibilitySeconds:1}]};var c="https://api.cxense.com/public/widget/visibility?callback={{callback}}"+"&json="+encodeURIComponent(cX.JSON.stringify(s));cX.jsonpRequest(c,(function(e){}),{synchronous:false})}}},trackVisibility:function(e,t,i,r){var n=document.getElementById(e);if(!n){return}if(t!==null&&r){if(cX.isAmpIFrame()){cX.trackAmpIFrame({trigger:{on:cX.createDelegate(this,(function(e){return e.visibility[this.visibilityField]>=this.trackTime})),callback:cX.createDelegate(this,(function(){this._reportWidgetVisible(t,i,r)}))}});return}var s;try{s=cX.library._domClosest(n,".cx-visibility-element")}catch(e){}if(s){n=s}else{var c=n.getElementsByClassName("cx-visibility-element");if(c&&c.length===1){n=c[0]}}cX.trackElement({element:n,trigger:{on:cX.createDelegate(this,(function(e){return e.visibility[this.visibilityField]>=this.trackTime})),callback:cX.createDelegate(this,(function(e){this._reportWidgetVisible(t,i,r)}))}})}},_instrumentClickLinks:function(e,t,i,r){var n=e&&e.targetElementId;var s=e&&e.ctrlLinksCss||"a";var c=e&&e.ctrlSpaAttr;var a=document.getElementById(n);if(!a){return}var o=[].slice.call(a.querySelectorAll(s)).filter(cX.createDelegate(this,(function(e){return this._getElemLink(e,c)})));for(var l=0;l<o.length;++l){var u=o[l];var d=this._getElemLink(u,c);var f=false;if(r){for(var p=0;p<r.length;++p){var h=r[p];if(h.click_url&&d===h.url){this._ctrlClickTracker(h.click_url,u,c);f=true;break}}}if(!f){var g="cx_testId="+encodeURIComponent(t)+"&cx_testVariant="+encodeURIComponent(i);if(e.experienceId){g+="&cx_experienceId="+encodeURIComponent(e.experienceId)}if(e.trackingId){g+="&cxTrackingId="+encodeURIComponent(e.trackingId)}d+=(d.indexOf("#")<0?"#":"&")+g+"&cx_artPos="+l;if(c){u.setAttribute(c,d)}else{u.href=d}}}},instrumentClickLinks:function(e,t,i){this._instrumentClickLinks({targetElementId:e},t,i)},_getElemLink:function(e,t){if(t){return e.getAttribute(t)}return e.href},_updateClickUrls:function(e,t){if(t){for(var i=0;i<t.length;++i){var r=t[i];if(r.click_url){if(!this._isEmptyType(r.type)){var n=r.testId||"0";var s=r.type==="ctrl"?"ctrl":"cx_"+(r.campaign||0);r.click_url+="?cx_testId="+n+"&cx_testVariant="+s+"&cx_artPos="+i;if(e.experienceId){r.click_url+="&cx_experienceId="+e.experienceId}if(e.trackingId){r.click_url+="&cxTrackingId="+encodeURIComponent(e.trackingId)}if(r.tag){r.click_url+="&cx_tag="+r.tag}if(r._type){r.click_url+="&cx_type="+r._type}if(r.offerProductId){r.click_url+="&cx_productId="+r.offerProductId}}}}}},updateRecsClickUrls:function(e,t,i){if(i){for(var r=0;r<i.length;++r){var n=i[r];if(n.click_url){n.click_url+="?cx_testId="+e+"&cx_testVariant="+t+"&cx_artPos="+r;if(n.tag){n.click_url+="&cx_tag="+n.tag}}}}},_ctrlClickTracker:function(e,t,i){if(!i){return cX.clickTracker(e,t)}else{window.requestAnimationFrame((function(){cX.addEventListener(t,"click",(function(){cX.sendSpaRecsClick(e)}))}))}},clickTracker:function(e,t,i){var r;if(e&&e.click_url){r=e.click_url}if(t){var n="cXLinkId"+cX.getRandomString();window.requestAnimationFrame((function(){var s=document.getElementById(n);if(s){cX.addEventListener(s,"mousedown",(function(){s.removeAttribute("href")}));cX.addEventListener(s,"touchstart",(function(){s.removeAttribute("href")}));cX.addEventListener(s,"click",(function(){cX.sendSpaRecsClick(r,(function(){t(e,i)}))}))}else{console.log("Missing linkId: "+n)}}));return n}else{var s=r.indexOf("?");if(s===r.length-1){r=r.substring(0,r.length-1)}var c="";if(i){cX.Object.forEach(i,(function(e,t){if(e!==undefined){c+=(c||s>=0?"&":"?")+t+"="+e}}))}var a=r.indexOf("#");if(a>=0){r=r.substring(0,a)+c+r.substring(a)}else{r=r+c}return cX.clickTracker(r)}},getDivId:function(e){if(e&&e.length){var t=document.getElementsByClassName(e);if(t&&t.length===1){var i=t[0];if(!(i.id&&i.id.length)){i.id=e+"-01"}return i.id}}return null},_processResult:function(e,t){if(t&&t.length){var i=t[0];if(!this._isEmptyType(i.type)){var r=i.testId||"0";var n=i.type==="ctrl"?"ctrl":"cx_"+(i.campaign||0);if(i.type==="ctrl"){this._instrumentClickLinks(e,r,n,t)}this.trackVisibility(e&&e.targetElementId,r,n,t)}}},processCxResult:function(e,t){var i=document.getElementById(t);if(!i){return}var r=null;if(i.previousElementSibling){r=i.previousElementSibling.id;if(i.className==="template"){i.parentNode.removeChild(i)}}this.trackVisibility(r||t,e,"cx")},_isEmptyType:function(e){return["noImpact","noVisual","free","abTest","piano"].indexOf(e)>=0},_isIgnoredResponse:function(e){if(e&&e.response&&e.response.items&&e.response.items.length){return this._isEmptyType(e.response.items[0].type)}return true},displayResult:function(e,t,i){if(!e){return}if(t.response.items&&t.response.items.length){if(t.response.items[0].type==="ctrl"){return}}var r=t.response.template;var n=t.response.style;var s=t.response.head;if(!r){return}if(n&&n.length){var c=document.createElement("style");c.type="text/css";if(c.styleSheet){c.styleSheet.cssText=n}else{c.appendChild(document.createTextNode(n))}document.getElementsByTagName("head")[0].appendChild(c)}if(s&&s.length){var a=document.createElement("script");a.type="text/javascript";a.text=s;document.getElementsByTagName("head")[0].appendChild(a)}if(this.snapPoints.length){if(!i){i={}}i.activeSnapPoint=this._getSnapPoint();this.activeWidgets.push({targetId:e,data:t,context:i,templateContent:r})}cX.library._renderTemplate(r,e,t,i)},runCxVersion:function(e,t,i,r,n){if(i.renderTemplateUrl){i.insertBeforeElementId=t;i.testId=e;i.testVariant="cx";i.onImpressionResult=cX.createDelegate(this,(function(){this.processCxResult(e,t,r);if(n){n()}}))}else{if(!i.renderFunction){i.renderFunction=cX.createDelegate(this,(function(i,r){if(e){this.updateRecsClickUrls(e,"cx",i.response.items)}this.displayResult(t,i);this.processCxResult(e,t);if(n){n(i,r)}}))}else{var s=i.renderFunction;i.renderFunction=cX.createDelegate(this,(function(i,r){this.updateRecsClickUrls(e,"cx",i.response.items);this.processCxResult(e,t);s(i,r);if(n){n(i,r)}}))}}r=this._applyContext(r,i);cX.insertWidget(i,r)},displayWidget:function(e,t,i,r){this.runCxVersion(null,e,t,i,r)},runCtrlVersion:function(e,t,i){this.instrumentClickLinks(t,e,"ctrl");this.trackVisibility(t,e,"ctrl");if(i){setTimeout(i,1)}},runTest:function(e,t,i,r,n,s){if(this.testVariant==="cx"){this.runCxVersion(e,t,r,n,s)}else if(this.testVariant==="ctrl"){this.runCtrlVersion(e,t,s)}else if(this.testGroup>-1&&i>0){if(this.testGroup<i*100){this.runCxVersion(e,t,r,n,s)}else if(this.testGroup>100*(1-i)){this.runCtrlVersion(e,t,s)}}else if(s){setTimeout(s,1)}},_renderFunction:function(e,t,i,r){if(!this._isIgnoredResponse(e)){this._updateClickUrls(i,e.response.items);this.displayResult(i&&i.targetElementId,e);this._processResult(i,e.response.items)}else{var n=e.response.items&&e.response.items.length>0&&e.response.items[0];if(n&&n.aid&&n.type==="piano"){cX.loadScript("https://sandbox.tinypass.com/xbuilder/experience/load?aid="+n.aid)}else if(n&&n.type==="abTest"){this.run({targetElementId:i&&i.targetElementId,widgetId:n.widgetId},null,(function(t,i){r(t,i,e)}));return}}this._executeCallback(r,e,t)},render:function(e,t,i,r){this._renderFunction(t,i,{targetElementId:e},r)},_executeCallback:function(e,t,i){if(e){if(typeof e==="function"){e(t,i)}else if(typeof e==="string"){if(window[e]&&typeof window[e]==="function"){window[e](t,i)}else{var r="cx_"+cX.getRandomString();var n=document.createElement("script");n.type="text/javascript";n.text="function "+r+"(data,context) {("+e+")(data,context);}";document.getElementsByTagName("head")[0].appendChild(n);if(window[r]&&typeof window[r]==="function"){window[r](t,i)}}}}},run:function(e,t,i){if(!e.widgetId){throw"Please provide 'widgetId'"}var r=i;if(this["__cx-toolkit__"].isShown){this["__cx-toolkit__"].data.push({widget:e.widgetId,params:e,responseData:null,responseContext:null,requestContext:t,isRendered:false});r=cX.createDelegate(this,(function(t,r){var n=this["__cx-toolkit__"].data;for(var s=0;s<n.length;s++){if(n[s].widget===e.widgetId&&n[s].params.targetElementId===e.targetElementId){n[s].isRendered=true;n[s].responseData=t;n[s].responseContext=r}}i(t,r)}))}e.renderFunction=cX.createDelegate(this,(function(t,i){this._renderFunction(t,i,e,r)}));t=this._applyContext(t,e);cX.insertWidget(e,t)},_runDuplicateRemoval:function(e,t,i){if(e.length>0){var r=e.shift();if(!r.widgetContext){r.widgetContext={}}if(!r.widgetContext.context){r.widgetContext.context={}}r.widgetContext.context.neighborRemovalKeys=t;r.widgetContext.context.neighbors=i;if(e.length>0){this.run(r.widgetParams,r.widgetContext,cX.createDelegate(this,(function(n,s){if(n&&n.response&&n.response.items&&n.response.items.length){for(var c=0;c<n.response.items.length;c++){var a=n.response.items[c];for(var o=0;o<t.length;o++){var l=a[t[o]];if(l){if(i.indexOf(l)===-1){i.push(l)}break}}}this._executeCallback(r.widgetCallback,n,s)}this._runDuplicateRemoval(e,t,i)})))}else{this.run(r.widgetParams,r.widgetContext,r.widgetCallback)}}},runMulti:function(e,t,i){if(!t){for(var r=0;r<e.length;r++){this.run(e[r].widgetParams,e[r].widgetContext,e[r].widgetCallback)}}else{var n=t===true?["recs-articleid","id"]:cX.isArray(t)?t:[t];this._runDuplicateRemoval(e,n,i||[])}},insertMaster:function(e,t,i){cX.insertWidget({widgetId:e,renderFunction:cX.createDelegate(this,(function(e){if(e&&e.response&&e.response.items&&e.response.items.length){var r=e.response.items[0];var n=[];if(r&&r.widgets){for(var s=0;s<r.widgets.length;s++){var c=r.widgets[s];if(c.widgetId&&c.targetElementId){n.push({widgetParams:{widgetId:c.widgetId,targetElementId:c.targetElementId},widgetContext:t,widgetCallback:c.callback})}}}this.runMulti(n,i)}}))},t)},_insertPreview:function(){if(this.previewId&&this.previewDiv!=="current"){if(this.previewDiv==="new"){var e=document.createElement("div");this.previewDiv="cx_preview_"+cX.getRandomString();e.setAttribute("id",this.previewDiv);document.body.insertBefore(e,document.body.firstChild)}this.run({widgetId:this.previewId,targetElementId:this.previewDiv})}},_showTools:function(e){if(this["__cx-toolkit__"].isShown===true){return}try{if(cX.hasLocalStorage()){localStorage.setItem("_cX_lastP1Time","0")}}catch(e){}this["__cx-toolkit__"].isShown=true;if("test"!=="test"){var t=(e?"https://local.cxense.com:9001/":"https://rscdn.cxense.com/")+"cxense-toolkit.js";(function(e,t,i,r,n,s){r=e.createElement(t);r.type="text/java"+t;r.async="async";r.src=i;r.onload=s;n=e.getElementsByTagName(t)[0];n.parentNode.insertBefore(r,n)})(document,"script",t,null,null,i)}else{i()}function i(){document.body.appendChild(document.createElement("cx-toolkit"))}},setTestGroup:function(e){this.testGroup=e},invoke:function(e){e.apply(window,Array.prototype.slice.call(arguments,1))},sendConversionEvent:function(e,t){e=e||{};t=t||{};var i=t.identities||[];if(!cX.Array.some(i,(function(e){return e.type==="cx"}))){i.push({id:cX.getUserId(),type:"cx"})}var r={events:[Object.assign(e,{eventType:"conversion",productId:e.productId||this.offerProductId,rnd:cX.getRandomString(),prnd:cX.library.m_rnd,siteId:cX.getSiteId(),userIds:i})]};var n=this.ccePushUrl+"&json="+encodeURIComponent(cX.JSON.stringify(r));cX.jsonpRequest(n,(function(e){if(t.callback){t.callback(e,{url:n,request:r})}}))}};(function(e,t,i,r){i=e.createElement(t);i.type="text/java"+t;i.async="async";i.src="https://images.yourstory.com/assets/js/cx.js";r=e.getElementsByTagName(t)[0];r.parentNode.insertBefore(i,r)})(document,"script")}function cxCCE_callQueueExecute(){try{var e=null;while(e=cX.CCE.callQueue.shift()){try{var t=e[0];var i=e.slice(1);cX.callQueue.push(["invoke",function(e,t){return function(){cX.CCE.library[e].apply(cX.CCE.library,t)}}(t,i)])}catch(e){}}}catch(e){}}setTimeout(cxCCE_callQueueExecute,25);cX.CCE.callQueue.push=function(){Array.prototype.push.apply(this,arguments);setTimeout(cxCCE_callQueueExecute,1);return this.length};(function(){for(var e in cX.CCE.library){if(cX.CCE.library.hasOwnProperty(e)){cX.CCE[e]=cX.CCE.library[e]}}})();if(!window.cxTest){window.cxTest=cX.CCE}}catch(e){console.log(e)}